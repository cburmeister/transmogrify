#!/bin/bash
#
# Simple script to download a YouTube video,
# extract the audio, and convert it to an mp3.
#
# Requires youtube-dl, ffmpeg, and lame.
#
# Example usage:
# ./transmogrify "http://www.youtube.com/watch?v=_VYggjoRb4o"

address=$1
regex='v=(.*)'

if [[ $address =~ $regex ]]; then
    filename=$(youtube-dl --get-filename $address)
    title=${filename%.*}

    youtube-dl $address
    ffmpeg -i "$filename" "$title".wav && rm "$filename"
    lame "$title".wav "$title".mp3 && rm "$title".wav
fi
